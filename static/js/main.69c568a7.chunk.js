(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{32:function(t,e,a){t.exports=a(64)},37:function(t,e,a){},62:function(t,e,a){},64:function(t,e,a){"use strict";a.r(e);var n=a(1),r=a.n(n),s=a(5),c=a.n(s),o=(a(37),a(6)),i=a.n(o),l=a(7),u=a(21),p=a(22),f=a(30),d=a(23),h=a(31),k=a(29),v=a(24),m=a(25),x=a(26),y=a.n(x),b=a(27),w=a(10),g=a.n(w),j="https://api.spotify.com/v1/";function O(t,e,a){return g.a.request({method:"get",url:j+"playlists/"+e+"/tracks",headers:{Authorization:"Bearer "+t},params:{offset:a}})}var E,T="https://accounts.spotify.com/authorize/?"+(E={client_id:"e774f35cd91c4fe68ab31fb58bd03e53",response_type:"token",redirect_uri:"https://naxulanth.github.io/spotify-playlist-exporter",scope:"playlist-read-private playlist-read-collaborative"},Object.keys(E).map(function(t){return"".concat(encodeURIComponent(t),"=").concat(encodeURIComponent(E[t]))}).join("&"));function C(){window.location.href=T}a(62);var S=function(t){function e(t){var a;return Object(u.a)(this,e),(a=Object(f.a)(this,Object(d.a)(e).call(this,t))).extractChunk=function(t,e){var n=a.state,r=n.tracks,s=n.playlists,c=Object.assign({},r);return new Promise(function(){var n=Object(l.a)(i.a.mark(function n(r,o){var l,u,p,f;return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:l=null,u=!1;case 2:return p=e.id,n.next=5,O(t,p,a.offsetTracks);case 5:f=n.sent,l=f.data.items,c[p]||(c[p]=[]),c[p]=c[p].concat(l),a.offsetTracks+=100,a.c===s.length-1&&(u=!0),a.setState({tracks:c,completed:u});case 12:if(100===l.length){n.next=2;break}case 13:a.offsetTracks=0,r();case 15:case"end":return n.stop()}},n)}));return function(t,e){return n.apply(this,arguments)}}())},a.extractTracks=function(){var t=Object(l.a)(i.a.mark(function t(e){var n,r,s,c,o,l,u,p;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=a.state,r=n.playlists,n.tracks,a.setState({extractingTracks:!0}),s=!0,c=!1,o=void 0,t.prev=5,l=r[Symbol.iterator]();case 7:if(s=(u=l.next()).done){t.next=15;break}return p=u.value,t.next=11,a.extractChunk(e,p);case 11:a.c++;case 12:s=!0,t.next=7;break;case 15:t.next=21;break;case 17:t.prev=17,t.t0=t.catch(5),c=!0,o=t.t0;case 21:t.prev=21,t.prev=22,s||null==l.return||l.return();case 24:if(t.prev=24,!c){t.next=27;break}throw o;case 27:return t.finish(24);case 28:return t.finish(21);case 29:a.setState({extractingTracks:!1});case 30:case"end":return t.stop()}},t,null,[[5,17,21,29],[22,,24,28]])}));return function(e){return t.apply(this,arguments)}}(),a.extractPlaylists=function(){var t=Object(l.a)(i.a.mark(function t(e){var n,r,s,c;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=a.state.playlists,r=null,s=n;case 3:return a.offset+=50,t.next=6,o=e,i=a.offset,g.a.request({method:"get",url:j+"me/playlists",headers:{Authorization:"Bearer "+o},params:{limit:50,offset:i}});case 6:c=t.sent,r=c.data.items,s=s.concat(r),a.setState({playlists:s});case 10:if(50===r.length){t.next=3;break}case 11:a.setState({extractingPlaylists:!1}),a.extractTracks(e);case 13:case"end":return t.stop()}var o,i},t)}));return function(e){return t.apply(this,arguments)}}(),a.toCsv=function(){var t=a.state.tracks,e=Object.keys(t).map(function(e){return t[e].map(function(t){return{track:t.track.name,artist:t.track.artists[0].name}})}),n=[].concat.apply([],e);n=y.a.uniq(n,function(t){return[t.track,t.artist].join()}),Object(m.parseAsync)(n,["track","artist"]).then(function(t){a.setState({exported:!0,csv:t})})},a.download=function(){var t=a.state.csv;t="data:text/csv;charset=utf-8,"+t;var e=encodeURI(t),n=document.createElement("a");n.setAttribute("href",e),n.setAttribute("download","spotify_export.csv"),n.click()},a.state={extractingPlaylists:!1,extractingTracks:!1,tracks:{},playlists:[],completed:!1,exported:!1},a.offset=0,a.offsetTracks=0,a.c=0,a}return Object(h.a)(e,t),Object(p.a)(e,[{key:"componentDidMount",value:function(){var t=function(){var t=window.location.hash&&window.location.hash.substring(1),e=null;return t.length>0&&(e=JSON.parse('{"'+t.replace(/&/g,'","').replace(/=/g,'":"')+'"}',function(t,e){return""===t?e:decodeURIComponent(e)})),e&&e.access_token}();t&&(this.setState({extractingPlaylists:!0}),this.extractPlaylists(t))}},{key:"componentDidUpdate",value:function(){var t=this.state,e=t.completed,a=t.exported;e&&!a&&this.toCsv()}},{key:"render",value:function(){var t=this.state,e=t.extractingPlaylists,a=t.extractingTracks,n=t.playlists,s=t.tracks,c=t.exported,o=0;return Object.keys(s).forEach(function(t){return o+=s[t].length}),r.a.createElement("div",{className:"center"},r.a.createElement(k.a,{disabled:e||a,onClick:c?this.download:C,className:"button"},r.a.createElement(v.a,{className:"spotify-icon",icon:b.a}),e?"Extracting playlists... ("+n.length+")":a?"Extracting tracks... ("+o+")":c?"Download":"Export"))}}]),e}(n.Component);a(63),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(S,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()})}},[[32,1,2]]]);
//# sourceMappingURL=main.69c568a7.chunk.js.map