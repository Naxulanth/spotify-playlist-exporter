(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{32:function(t,e,a){t.exports=a(64)},37:function(t,e,a){},62:function(t,e,a){},64:function(t,e,a){"use strict";a.r(e);var n=a(1),r=a.n(n),c=a(5),s=a.n(c),o=(a(37),a(6)),i=a.n(o),l=a(7),u=a(21),p=a(22),f=a(30),d=a(23),h=a(31),k=a(29),v=a(24),m=a(25),x=a(26),y=a.n(x),b=a(27),w=a(10),g=a.n(w),j="https://api.spotify.com/v1/";function O(t,e,a){return g.a.request({method:"get",url:j+"playlists/"+e+"/tracks",headers:{Authorization:"Bearer "+t},params:{offset:a}})}var E,T="https://accounts.spotify.com/authorize/?"+(E={client_id:"e774f35cd91c4fe68ab31fb58bd03e53",response_type:"token",redirect_uri:"https://naxulanth.github.io/spotify-playlist-exporter",scope:"playlist-read-private playlist-read-collaborative"},Object.keys(E).map(function(t){return"".concat(encodeURIComponent(t),"=").concat(encodeURIComponent(E[t]))}).join("&"));function C(){window.location.href=T}a(62);var S=function(t){function e(t){var a;return Object(u.a)(this,e),(a=Object(f.a)(this,Object(d.a)(e).call(this,t))).extractChunk=function(t,e){var n=a.state,r=n.tracks,c=n.playlists,s=Object.assign({},r);return new Promise(function(){var n=Object(l.a)(i.a.mark(function n(r,o){var l,u,p,f;return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:l=null,u=!1;case 2:return p=e.id,n.prev=3,n.next=6,O(t,p,a.offsetTracks);case 6:f=n.sent,l=f.data.items,s[p]||(s[p]=[]),s[p]=s[p].concat(l),a.offsetTracks+=100,a.c===c.length-1&&(u=!0),a.setState({tracks:s,completed:u}),n.next=18;break;case 15:n.prev=15,n.t0=n.catch(3),console.error(n.t0);case 18:if(100===l.length){n.next=2;break}case 19:a.offsetTracks=0,r();case 21:case"end":return n.stop()}},n,null,[[3,15]])}));return function(t,e){return n.apply(this,arguments)}}())},a.extractTracks=function(){var t=Object(l.a)(i.a.mark(function t(e){var n,r,c,s,o,l,u;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=a.state.playlists,a.setState({extractingTracks:!0}),r=!0,c=!1,s=void 0,t.prev=5,o=n[Symbol.iterator]();case 7:if(r=(l=o.next()).done){t.next=15;break}return u=l.value,t.next=11,a.extractChunk(e,u);case 11:a.c++;case 12:r=!0,t.next=7;break;case 15:t.next=21;break;case 17:t.prev=17,t.t0=t.catch(5),c=!0,s=t.t0;case 21:t.prev=21,t.prev=22,r||null==o.return||o.return();case 24:if(t.prev=24,!c){t.next=27;break}throw s;case 27:return t.finish(24);case 28:return t.finish(21);case 29:a.setState({extractingTracks:!1});case 30:case"end":return t.stop()}},t,null,[[5,17,21,29],[22,,24,28]])}));return function(e){return t.apply(this,arguments)}}(),a.extractPlaylists=function(){var t=Object(l.a)(i.a.mark(function t(e){var n,r,c,s;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=a.state.playlists,r=null,c=n;case 3:return t.prev=3,a.offset+=50,t.next=7,o=e,i=a.offset,g.a.request({method:"get",url:j+"me/playlists",headers:{Authorization:"Bearer "+o},params:{limit:50,offset:i}});case 7:s=t.sent,r=s.data.items,c=c.concat(r),a.setState({playlists:c}),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(3),console.error(t.t0);case 16:if(50===r.length){t.next=3;break}case 17:a.setState({extractingPlaylists:!1}),a.extractTracks(e);case 19:case"end":return t.stop()}var o,i},t,null,[[3,13]])}));return function(e){return t.apply(this,arguments)}}(),a.toCsv=function(){var t=a.state.tracks,e=Object.keys(t).map(function(e){return t[e].map(function(t){return t.track&&t.track.name||console.log(t),{track:t.track&&t.track.name,artist:t.track&&t.track.artists&&t.track.artists[0]&&t.track.artists[0].name}})}),n=[].concat.apply([],e);n=y.a.uniq(n,function(t){return[t.track,t.artist].join()}),Object(m.parseAsync)(n,["track","artist"]).then(function(t){a.setState({exported:!0,csv:t})})},a.download=function(){var t=a.state.csv;t="data:text/csv;charset=utf-8,"+t;var e=encodeURI(t),n=document.createElement("a");n.setAttribute("href",e),n.setAttribute("download","spotify_export.csv"),n.click()},a.state={extractingPlaylists:!1,extractingTracks:!1,tracks:{},playlists:[],completed:!1,exported:!1},a.offset=0,a.offsetTracks=0,a.c=0,a}return Object(h.a)(e,t),Object(p.a)(e,[{key:"componentDidMount",value:function(){var t=function(){var t=window.location.hash&&window.location.hash.substring(1),e=null;return t.length>0&&(e=JSON.parse('{"'+t.replace(/&/g,'","').replace(/=/g,'":"')+'"}',function(t,e){return""===t?e:decodeURIComponent(e)})),e&&e.access_token}();t&&(this.setState({extractingPlaylists:!0}),this.extractPlaylists(t))}},{key:"componentDidUpdate",value:function(){var t=this.state,e=t.completed,a=t.exported;e&&!a&&this.toCsv()}},{key:"render",value:function(){var t=this.state,e=t.extractingPlaylists,a=t.extractingTracks,n=t.playlists,c=t.tracks,s=t.exported,o=0;return Object.keys(c).forEach(function(t){return o+=c[t].length}),r.a.createElement("div",{className:"center"},r.a.createElement(k.a,{disabled:e||a,onClick:s?this.download:C,className:"button"},r.a.createElement(v.a,{className:"spotify-icon",icon:b.a}),e?"Extracting playlists... ("+n.length+")":a?"Extracting tracks... ("+o+")":s?"Download":"Export"))}}]),e}(n.Component);a(63),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(S,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()})}},[[32,1,2]]]);
//# sourceMappingURL=main.657bf6d2.chunk.js.map